<div id="tp_top" class="clearfix">
  <% form_tag({}, {:id => "tp_filter", :method => :get}) do %>
  <table>
    <tr>
      <td><label for="title">Search:</label></td>
      <td>
        <div id="tp_tb">
          <%= text_field_tag :title, list_params[:title], :autocomplete => 'off' %>
              <script type="text/javascript">
              new Form.Element.DelayedObserver('title', 0.4, function(element, value) {
                when_starting();
                new Ajax.Updater('tp_ajax_update', '/admin/tiny_paper/images', {
                  asynchronous:true,
                  evalScripts:true,
                  method:'get',
                  onComplete: function(request){when_completing()},
                  parameters: 'title=' + escape(value) + '&authenticity_token=' + encodeURIComponent('<%= form_authenticity_token %>')
                })
              })  
              </script>
          <%= reset_filters_tag %>
        </div>
      </td>
      <td><img id="spinner" style="display:none" src="/images/admin/spinner.gif" alt="loading" /></td>
    </tr>
  </table>
  <% end -%>
</div><!-- div tp_top -->

<%= show_flash_message %>

<div id="tp_bd" class="clearfix">
  <div id="tp_sidebar">
    <div id="tp_view">
      <% form_tag({}, {:id => 'tp_view_mode', :method => :get}) do %>
      <table class="tp_form">
        <tr><th><label>View:</label></th></tr>
        <tr><td><%= link_to 'text list', :view => 'text_list', :page => 1 %></td></tr>
        <tr><td><%= link_to 'thumbnails', :view => 'thumbnails' %></td></tr>
      </table>
      <% end -%>
    </div>
    <div id="tp_sizes">
      <% form_tag({}, {:id => 'tp_thumbs', :method => :get}) do %>
      <table class="tp_form">
        <tr><th><label>Size:</label></th></tr>
        <% @thumbnails.each do |k,v| %>
        <tr><td><%= link_to_size(k,v) %></td></tr>
        <% end -%>
        <tr><td><%= link_to_size("original","") %></td></tr>
      </table>
      <% end -%>
    </div>
    <%= render :partial => "upload" %>
  </div>

  <div id="tp_content">    
    <%= render :partial => "images_images" if list_params[:view] == "thumbnails" %>
    <%= render :partial => "images_titles" if list_params[:view] == "text_list" %>
  </div>
</div>
<input type="hidden" id="type" name="type" value="files" />